<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Slide</title>
    <style>
        :root {
            --bg-main: #f6f9fc;
            --color-card: #ffffff;
            --color-primary: #002b55;
            --color-secondary: #007acc;
            --color-accent: #f9578f;
            --color-text-light: #f0f0f0;
            --color-text-dark: #333333;
            --space-gap: 12px;
            --space-padding: 16px;
            --font-family: "Segoe UI", "Roboto", "Arial", sans-serif;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: var(--font-family);
            background-color: #e0e0e0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden;
        }

        #viewport-frame {
            width: 1920px;
            height: 1080px;
            background-color: var(--bg-main);
            padding: var(--space-gap);
            border: 1px solid #ccc;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            position: relative;
        }
        
        #slide-container {
            width: 100%;
            height: 100%;
            display: flex;
            gap: var(--space-gap);
        }
        
        .column {
            display: flex;
            flex-direction: column;
            gap: var(--space-gap);
            flex: 1;
            min-width: 0;
        }

        .component-card {
            background-color: var(--color-card);
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06);
            padding: var(--space-padding);
            display: flex;
            flex-direction: column;
            overflow: visible; /* Make overflow visible to ensure all content is rendered */
            position: relative; /* For action buttons */
            touch-action: none;
            user-select: none;
        }

        .component-card:hover .card-actions {
            opacity: 1;
        }

        .card-actions {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 8px;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(4px);
            padding: 5px;
            border-radius: 5px;
            opacity: 0;
            transition: opacity 0.2s ease-in-out;
            z-index: 10;
        }

        .card-actions button {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            color: var(--color-primary);
        }
        .card-actions button:hover {
            color: var(--color-accent);
        }

        h1, h2, h3, h4, h5, h6, p, span, li, th, td {
            outline: none;
        }

        .card-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--color-primary);
            margin-bottom: var(--space-gap);
            border-bottom: 2px solid var(--color-secondary);
            padding-bottom: 12px;
            display: flex;
            align-items: center;
        }

        .card-title i {
            margin-right: 12px;
            color: var(--color-secondary);
        }
        
        .element-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--color-secondary);
            margin-bottom: 12px;
            margin-top: 12px;
        }
        
        .text-content, p, li {
            font-size: 16px;
            line-height: 1.6;
            color: var(--color-text-dark);
        }

        .component-card .content-wrapper {
            flex-grow: 1;
            min-height: 0;
        }

        /* Table Styles */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        .data-table th, .data-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
            font-size: 16px;
        }
        .data-table th {
            font-weight: 600;
            color: var(--color-primary);
            background-color: #f9fafb;
        }
        .data-table tr:last-child td {
            border-bottom: none;
        }
        .data-table tr:hover {
            background-color: #f6f9fc;
        }

        /* Card Grid Styles */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: var(--space-gap);
            margin-top: 10px;
        }
        .grid-item {
            background: #fdfdfd;
            border: 1px solid #eee;
            border-radius: 6px;
            padding: var(--space-padding);
        }
        .grid-item-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--color-primary);
            margin-bottom: 8px;
        }

        /* Bullet List Styles */
        .bullet-list ul {
            list-style: none;
            padding-left: 0;
        }
        .bullet-list ul li {
            display: flex;
            align-items: flex-start;
            margin-bottom: 12px;
            font-size: 16px;
            line-height: 1.6;
        }
        .bullet-list ul li i {
            margin-right: 12px;
            color: var(--color-accent);
            margin-top: 5px;
            font-size: 14px;
        }

        /* Columnar Lists Styles */
        .columnar-lists {
            display: flex;
            gap: var(--space-gap);
            flex-grow: 1;
        }
        .columnar-list-column {
            flex: 1;
            min-width: 0;
        }
        .columnar-list-column ul {
            list-style: none;
            padding-left: 0;
        }
        .columnar-list-column ul li {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            font-size: 15px;
        }
        .columnar-list-column ul li i {
            margin-right: 10px;
            color: var(--color-secondary);
        }

    </style>
</head>
<body>

    <div id="viewport-frame">
        <div id="slide-container"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js"></script>
    <script src="https://kit.fontawesome.com/649392c3a4.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        const INPUT_JSON = {
          "components": [
            {
              "componentType": "companyOverview",
              "slideNumber": 1,
              "renderBlock": {
                "type": "COMPOSITE",
                "title": "Company Overview",
                "elements": [
                  {
                    "type": "TEXT_BLOCK",
                    "title": "Company Snapshot",
                    "content": "A leading tin can manufacturer for industrial packaging, founded in 1981. Specializes in cans for plumbing, automotive, and paint industries. Has 60M annual capacity and ~27% CAGR."
                  },
                  {
                    "type": "TABLE",
                    "title": "Key Milestones",
                    "data": {
                      "columns": [
                        "Year",
                        "Description"
                      ],
                      "rows": [
                        [
                          "1981",
                          "Established as a manufacturer and exporter of industrial packaging solutions."
                        ],
                        [
                          "Nov 2010",
                          "Incorporated as a private limited entity."
                        ],
                        [
                          "Mar 2023",
                          "Generated revenue of â‚¹751.58 Million."
                        ],
                        [
                          "Ongoing",
                          "Achieved 60 million cans annual production capacity."
                        ],
                        [
                          "Last Decade",
                          "Experienced an approximate 27% CAGR."
                        ]
                      ]
                    }
                  }
                ]
              }
            },
            {
              "componentType": "productPortfolio",
              "slideNumber": 1,
              "renderBlock": {
                "type": "COMPOSITE",
                "title": "Product Portfolio",
                "elements": [
                  {
                    "type": "TEXT_BLOCK",
                    "title": "Portfolio Overview",
                    "content": "Leading manufacturer of high-quality tin cans for diverse industrial packaging. Annual production capacity is 60 million cans."
                  },
                  {
                    "type": "CARD_GRID",
                    "title": "Major Product Categories",
                    "items": [
                      {
                        "title": "Monotop Cans and Daubers / Brush in Cans",
                        "content": "For plumbing, construction chemicals, adhesives, and solvent cement applications."
                      },
                      {
                        "title": "Cone Top, Pour Top and Oil Cans",
                        "content": "Packaging for automotive fluids and additives for industrial use."
                      },
                      {
                        "title": "Fstyle Cans",
                        "content": "Used for packaging various chemicals, solvents, and lubricants."
                      },
                      {
                        "title": "Paint Cans",
                        "content": "Designed for paints, coatings, and adhesives in the paint industry."
                      }
                    ]
                  },
                  {
                    "type": "TEXT_BLOCK",
                    "title": "Innovation Focus",
                    "content": "Strategic expansion into the beverage can sector, focusing on aluminum and steel cans."
                  }
                ]
              }
            },
            {
              "componentType": "manufacturingCapabilities",
              "slideNumber": 1,
              "renderBlock": {
                "type": "BULLET_LIST",
                "title": "Manufacturing Capabilities",
                "items": [
                  "Installed Capacity: 60 million units per annum (single shift), specializing in diverse tin can types.",
                  "Infrastructure: 30,000+ sq. meters in a major Indian metropolitan area, strategically located.",
                  "Process: Quality-conscious manufacturing focused on innovation and precision in tin can production.",
                  "Quality: AEO certified and recognized as a Star Export House, adhering to high standards."
                ]
              }
            },
            {
              "componentType": "marketReachAndClientBase",
              "slideNumber": 1,
              "renderBlock": {
                "type": "COMPOSITE",
                "title": "Market Reach & Client Base",
                "elements": [
                  {
                    "type": "COLUMNAR_LISTS",
                    "title": "Presence & Industries",
                    "columns": [
                      {
                        "title": "Geographic Presence",
                        "items": [
                          "India", "Bangladesh", "Canada", "China", "Egypt", "Guatemala", "Jordan", "Saudi Arabia", "Turkey", "United States", "UAE", "West Indies"
                        ]
                      },
                      {
                        "title": "Primary Industries Served",
                        "items": [
                          "Plumbing", "Automotive", "Industrial Products", "Paint Industry", "Chemicals", "Construction Chemicals", "Adhesives", "Solvent Cement"
                        ]
                      }
                    ]
                  },
                  {
                    "type": "TEXT_BLOCK",
                    "title": "Client Archetype",
                    "content": "B2B industrial manufacturers and distributors requiring high-quality tin cans for various packaging."
                  }
                ]
              }
            }
          ]
        };

        function getIcon(text) {
            const lowerText = text.toLowerCase();
            if (lowerText.includes('overview') || lowerText.includes('snapshot')) return 'fa-solid fa-building';
            if (lowerText.includes('product') || lowerText.includes('portfolio')) return 'fa-solid fa-boxes-stacked';
            if (lowerText.includes('manufactur') || lowerText.includes('capabilit')) return 'fa-solid fa-industry';
            if (lowerText.includes('market') || lowerText.includes('client')) return 'fa-solid fa-globe-americas';
            if (lowerText.includes('year') || lowerText.includes('milestone')) return 'fa-solid fa-flag';
            if (lowerText.includes('description')) return 'fa-solid fa-file-alt';
            if (lowerText.includes('capacity')) return 'fa-solid fa-gauge-high';
            if (lowerText.includes('infra')) return 'fa-solid fa-warehouse';
            if (lowerText.includes('process')) return 'fa-solid fa-gears';
            if (lowerText.includes('quality')) return 'fa-solid fa-award';
            if (lowerText.includes('geo') || lowerText.includes('presence')) return 'fa-solid fa-map-marker-alt';
            if (lowerText.includes('industr')) return 'fa-solid fa-tags';
            if (lowerText.includes('client') || lowerText.includes('user')) return 'fa-solid fa-users';
            if (lowerText.includes('innovat')) return 'fa-solid fa-lightbulb';
            return 'fa-solid fa-circle-dot';
        }

        function renderComponent(componentData) {
            const { type, title } = componentData.renderBlock;
            let contentHtml = '';

            switch (type) {
                case 'COMPOSITE':
                    contentHtml = componentData.renderBlock.elements.map(renderElement).join('');
                    break;
                case 'BULLET_LIST':
                    contentHtml = renderBulletList(componentData.renderBlock);
                    break;
                // Add other component types here if needed
            }

            return `
                <div class="component-card" style="flex-grow: ${componentData.flexGrow || 1};">
                    <div class="card-actions">
                        <button class="action-duplicate" title="Duplicate"><i class="fa-solid fa-clone"></i></button>
                        <button class="action-delete" title="Delete"><i class="fa-solid fa-trash"></i></button>
                    </div>
                    <h3 class="card-title" contenteditable="true"><i class="${getIcon(title)}"></i> ${title}</h3>
                    <div class="content-wrapper">${contentHtml}</div>
                </div>
            `;
        }

        function renderElement(element) {
            switch (element.type) {
                case 'TEXT_BLOCK':
                    return `
                        <div>
                            <h4 class="element-title" contenteditable="true">${element.title}</h4>
                            <p class="text-content" contenteditable="true">${element.content}</p>
                        </div>
                    `;
                case 'TABLE':
                    return `
                        <div>
                            <h4 class="element-title" contenteditable="true">${element.title}</h4>
                            <table class="data-table">
                                <thead>
                                    <tr>${element.data.columns.map(col => `<th contenteditable="true">${col}</th>`).join('')}</tr>
                                </thead>
                                <tbody>
                                    ${element.data.rows.map(row => `<tr>${row.map(cell => `<td contenteditable="true">${cell}</td>`).join('')}</tr>`).join('')}
                                </tbody>
                            </table>
                        </div>
                    `;
                case 'CARD_GRID':
                    return `
                        <div>
                            <h4 class="element-title" contenteditable="true">${element.title}</h4>
                            <div class="card-grid">
                                ${element.items.map(item => `
                                    <div class="grid-item">
                                        <h5 class="grid-item-title" contenteditable="true">${item.title}</h5>
                                        <p contenteditable="true">${item.content}</p>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                case 'COLUMNAR_LISTS':
                    return `
                        <div class="columnar-lists-container">
                            <h4 class="element-title" contenteditable="true">${element.title}</h4>
                            <div class="columnar-lists">
                                ${element.columns.map(col => `
                                    <div class="columnar-list-column">
                                        <h5 class="element-title" style="font-size: 18px;" contenteditable="true">${col.title}</h5>
                                        <ul>
                                            ${col.items.map(item => `<li contenteditable="true"><i class="${getIcon(col.title)}"></i><span>${item}</span></li>`).join('')}
                                        </ul>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                default:
                    return '';
            }
        }
        
        function renderBulletList(data) {
            return `
                <div class="bullet-list">
                    <ul>
                        ${data.items.map(item => `<li contenteditable="true"><i class="fa-solid fa-check"></i><span>${item}</span></li>`).join('')}
                    </ul>
                </div>
            `;
        }


        function initializeSlide() {
            const container = document.getElementById('slide-container');
            if (!container) return;

            const components = INPUT_JSON.components;
            
            // Find components
            const overview = components.find(c => c.componentType === 'companyOverview');
            const product = components.find(c => c.componentType === 'productPortfolio');
            const manufacturing = components.find(c => c.componentType === 'manufacturingCapabilities');
            const market = components.find(c => c.componentType === 'marketReachAndClientBase');
            
            // CRITICAL FIX: Assign flex-grow values for better space distribution
            overview.flexGrow = 1.6; // Has table, needs more space
            market.flexGrow = 1.4;   // Has two long lists
            product.flexGrow = 1;    // Medium content
            manufacturing.flexGrow = 0.5; // Shortest content

            // RE-ARRANGE for better balance
            const column1Html = renderComponent(overview) + renderComponent(manufacturing); // Longest + Shortest
            const column2Html = renderComponent(product) + renderComponent(market);       // Two medium components
            
            container.innerHTML = `
                <div class="column">${column1Html}</div>
                <div class="column">${column2Html}</div>
            `;

            initInteractivity();
        }
        
        function initInteractivity() {
            // Drag and Resize functionality
            interact('.component-card')
                .draggable({
                    inertia: true,
                    modifiers: [
                        interact.modifiers.restrictRect({
                            restriction: 'parent',
                            endOnly: true
                        })
                    ],
                    autoScroll: true,
                    listeners: {
                        move: dragMoveListener
                    }
                })
                .resizable({
                    edges: { left: true, right: true, bottom: true, top: true },
                    listeners: {
                        move: function (event) {
                            let { x, y } = event.target.dataset;
                            x = (parseFloat(x) || 0);
                            y = (parseFloat(y) || 0);

                            Object.assign(event.target.style, {
                                width: `${event.rect.width}px`,
                                height: `${event.rect.height}px`,
                            });

                            Object.assign(event.target.dataset, { x, y });
                        }
                    },
                    inertia: true
                });

            function dragMoveListener(event) {
                const target = event.target;
                const x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx;
                const y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;

                target.style.transform = `translate(${x}px, ${y}px)`;
                target.setAttribute('data-x', x);
                target.setAttribute('data-y', y);
            }
            
            // Delete and Duplicate functionality using event delegation
            document.getElementById('slide-container').addEventListener('click', function(event) {
                const target = event.target.closest('button');
                if (!target) return;

                const card = target.closest('.component-card');
                if (!card) return;

                if (target.classList.contains('action-delete')) {
                    card.remove();
                } else if (target.classList.contains('action-duplicate')) {
                    const clone = card.cloneNode(true);
                    
                    // Reset position for the clone
                    clone.style.transform = 'translate(20px, 20px)';
                    clone.setAttribute('data-x', '20');
                    clone.setAttribute('data-y', '20');
                    
                    card.parentElement.appendChild(clone);
                }
            });
        }


        document.addEventListener('DOMContentLoaded', initializeSlide);
    </script>
</body>
</html>